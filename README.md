# Laravel Stripe Checkout Demo
This project demonstrates how to integrate Stripe’s hosted checkout page into a Laravel application. It walks through the essential steps for setting up a Stripe-powered payment gateway using the `stripe/stripe-php` library, creating dummy products, and handling various stages of the checkout process (success, cancellation, and delayed transactions via webhooks).

## Features
__Stripe Checkout:__ Implements Stripe's hosted checkout page where users can purchase dummy products from the application.

__Dummy Products:__ Creates dummy products using Laravel’s factory ProductFactory and seeder to populate the database.

__Checkout Button:__ Simple form with a "Checkout" button that redirects users to the Stripe-hosted checkout page.

__Success & Cancel URLs:__ Handles redirection after successful or cancelled payments.

__Stripe Webhook:__ Includes a webhook to handle delayed transactions and updates the payment status in the app.


## Technologies Used
__Laravel:__ PHP framework used for building the application.

__Stripe API:__ Integration via the official stripe/stripe-php package.

__MySQL:__ For database management.

__Composer:__ PHP dependency management tool.


## Installation
### Prerequisites
- PHP >= 8.0
- Composer
- Laravel >= 9.x
- Stripe account (with test mode enabled)
- MySQL (or other DB engines supported by Laravel)


## Setup
__Clone the repository:__
git clone https://github.com/your-username/stripe-laravel-demo.git
cd stripe-laravel-demo

__Install dependencies:__
composer install

__Create a .env file:__
Copy the .env.example to .env and update the necessary environment variables, particularly:

- STRIPE_KEY=your_stripe_publishable_key
- STRIPE_SECRET=your_stripe_secret_key
- STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret (if you are using webhooks)


__Run database migrations:__
Migrate the database to create the necessary tables:
php artisan migrate

__Seed the database:__
Run the seeder to populate your database with dummy products:
- php artisan db:seed

__Start the local development server:__
php artisan serve


## Creating Stripe Checkout Sessions
In this demo, we create a Stripe Checkout session linked to the dummy products created via the ProductFactory. Users are redirected to Stripe’s hosted checkout page to complete the payment.

## Usage
### Stripe Checkout
On the main page, users can see a list of dummy products generated by the ProductFactory.
Users can select items and proceed to the checkout page by clicking the Checkout button.
After clicking Checkout, users will be redirected to Stripe's hosted checkout page, where they can complete the payment.
Upon successful payment, the user will be redirected to the `success URL`.
If the user cancels the payment, they will be redirected to the `cancel URL`.

### Webhook Handling
For transactions with delayed confirmation, a webhook is set up to listen for Stripe events and update the transaction status in the app.

To test this locally, use Stripe’s CLI or a tunneling service like ngrok to expose your local environment and test webhook events.

stripe listen --forward-to http://localhost:8000/stripe/webhook
You can then trigger a test event using Stripe’s CLI or dashboard to test the webhook functionality.

## File Structure
__Factories/ProductFactory.php:__ Creates dummy products for the database.
__Seeders/ProductSeeder.php:__ Seeds the database with products.
__Controllers/CheckoutController.php:__ Handles the Stripe Checkout session creation.
__Routes/web.php:__ Defines routes for the product listing, checkout, success, cancel, and webhook endpoints.
__Views/checkout.blade.php:__ Simple form that allows users to select products and initiate the checkout process.


## Running Tests
To run the tests for this application:
php artisan test


##  Credits
Stripe for the API and documentation.
Laravel documentation and resources.


## License
This project is open-sourced software licensed under the MIT license.